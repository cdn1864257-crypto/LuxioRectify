Je veux que tu implÃ©mentes dans mon projet full-stack JavaScript un systÃ¨me complet de coupons promotionnels selon les rÃ¨gles suivantes :

ğŸ¯ RÃ¨gles du coupon

Le coupon doit Ãªtre automatiquement gÃ©nÃ©rÃ© aprÃ¨s une commande si :

lâ€™utilisateur achÃ¨te plus de 2 tÃ©lÃ©phones,

et que le montant total de la commande est dâ€™au moins 3000 â‚¬.

Le coupon donne une rÃ©duction supplÃ©mentaire de 15 % sur une future commande.

Le coupon doit Ãªtre :

unique,

utilisable une seule fois,

avec une date d'expiration configurable (par dÃ©faut 30 jours).

Le client doit recevoir automatiquement le code du coupon (par email ou via son compte utilisateur).

ğŸ—‚ Ce que je veux comme implÃ©mentation complÃ¨te

Merci de gÃ©nÃ©rer toute la structure du systÃ¨me, incluant :

1. Backend : Node.js / Express / MongoDB

ModÃ¨le MongoDB Coupon avec les champs :

code: String,
discount: Number,   // 15
userId: ObjectId,
orderId: ObjectId,
expirationDate: Date,
used: Boolean


Modifications dans le modÃ¨le ou le contrÃ´leur Order pour :

dÃ©tecter si la commande dÃ©passe les critÃ¨res,

gÃ©nÃ©rer un coupon unique au format :
PROMO15-[orderId]-[8 caractÃ¨res alÃ©atoires]

Function helper generateCouponCode()

Route API :

POST /api/coupons/validate
â†’ VÃ©rifie la validitÃ© du coupon (existe, non utilisÃ©, non expirÃ©)

POST /api/coupons/apply
â†’ Applique la rÃ©duction de 15 % sur le montant dâ€™une commande

GET /api/coupons/my-coupons
â†’ Renvoie les coupons du client connectÃ©

2. Frontend : React

Composant ApplyCoupon.jsx permettant au client :

dâ€™entrer un code promo

de vÃ©rifier sa validitÃ©

de voir le nouveau total aprÃ¨s rÃ©duction

Composant MyCoupons.jsx affichant les coupons gÃ©nÃ©rÃ©s

IntÃ©gration dans la page Checkout :

champ "Code promo"

bouton "Appliquer"

affichage du montant final aprÃ¨s rÃ©duction

3. FonctionnalitÃ©s supplÃ©mentaires

Envoyer automatiquement un email avec le coupon juste aprÃ¨s la commande (utilise nodemailer ou autre).

SÃ©curiser lâ€™usage des coupons :

impossible Ã  rÃ©utiliser

impossible dâ€™utiliser un coupon expirÃ©

impossible dâ€™utiliser un coupon appartenant Ã  un autre utilisateur

Ajout de tests unitaires ou dâ€™intÃ©gration si possible.

ğŸ“Œ Objectif final

Ã€ la fin, je veux que tu me fournis :

les fichiers complets (backend + frontend)

tout le code prÃªt Ã  coller dans mon projet

les explications dâ€™intÃ©gration

les endpoints API

les modÃ¨les MongoDB

tout le systÃ¨me de gÃ©nÃ©ration + validation + utilisation des coupons

le workflow complet du checkout avec coupon.

Merci de produire le code final, structurÃ© et prÃªt Ã  lâ€™emploi pour un projet full-stack JavaScript.